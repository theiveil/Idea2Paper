{
  "__comment__": "Copy this file to `i2p_config.json` (repo root). It is for NON-sensitive settings. Priority: shell env > .env > i2p_config.json > defaults. Secrets (e.g. SILICONFLOW_API_KEY) should go to `.env`, not here.",
  "logging": {
    "__comment__": "Run logging writes a folder per run: log/run_YYYYMMDD_HHMMSS_<pid>_<rand>/. Set enable=false to disable logging entirely.",
    "enable": true,
    "dir": "log",
    "max_text_chars": 20000
  },
  "critic": {
    "__comment__": "Anchored Multi-Agent Critic JSON strictness. strict_json=true means: invalid JSON -> retry -> still invalid => fail the run (no silent fallback).",
    "strict_json": true,
    "json_retries": 2
  },
  "pass": {
    "__comment__": "Pattern-aware pass rule based on the pattern's full real score10 distribution (NOT anchors). Default scheme: 2 of 3 roles >= q75 and avg >= q50.",
    "mode": "two_of_three_q75_and_avg_ge_q50",
    "min_pattern_papers": 20,
    "fallback": "global",
    "fixed_score": 7.0
  },
  "anchors": {
    "__comment__": "Anchor selection + deterministic scoring knobs. densify_enable=false skips adaptive densify (no Round2), reducing LLM calls/latency. Usually keep defaults unless you know what you're doing.",
    "quantiles": [0.1, 0.25, 0.5, 0.75, 0.9],
    "max_initial": 7,
    "max_total": 9,
    "max_exemplars": 2,
    "densify_offsets": [-0.5, 0.5, -0.25, 0.25],
    "sigmoid_k": 1.2,
    "grid_step": 0.01,
    "densify_loss_threshold": 0.03,
    "densify_min_avg_conf": 0.45,
    "densify_enable": true
  },
  "llm": {
    "__comment__": "LLM endpoint/model settings. The API key is read from env var SILICONFLOW_API_KEY in `.env` (do not put it here).",
    "api_url": "https://api.siliconflow.cn/v1/chat/completions",
    "model": "Pro/zai-org/GLM-4.7"
  },
  "embedding": {
    "__comment__": "Embedding endpoint/model settings (non-sensitive). Secret EMBEDDING_API_KEY should stay in .env. Recommended: set index.dir_mode=auto_profile (or env I2P_INDEX_DIR_MODE) to auto-manage per-embedding index dirs, e.g. Paper-KG-Pipeline/output/novelty_index__siliconflow__Qwen_Qwen3-Embedding-8B__<hash>.",
    "provider": "siliconflow",
    "api_url": "https://api.siliconflow.cn/v1/embeddings",
    "model": "Qwen/Qwen3-Embedding-8B"
  },
  "results": {
    "__comment__": "Aggregate final artifacts to repo-root results/run_.../ for better UX.",
    "enable": true,
    "dir": "results",
    "mode": "link",
    "keep_log": true
  },
  "verification": {
    "__comment__": "Phase 4 final collision check. enable=false will skip verification and disable pivot triggered by collision. Recommendation: set collision_threshold between novelty.medium_th and novelty.high_th (e.g. 0.82~0.88). Higher = fewer false positives but may miss near-duplicates; lower = more pivots.",
    "enable": true,
    "collision_threshold": 0.88
  },
  "index": {
    "__comment__": "Auto-prepare required indexes before running the pipeline. dir_mode=manual (default) uses fixed index_dir; dir_mode=auto_profile derives dirs from embedding provider/model/url.",
    "dir_mode": "auto_profile",
    "auto_prepare": true,
    "allow_build": true
  },
  "recall": {
    "__comment__": "Persist recall candidates (Top ideas/domains/papers + final Top patterns) into pipeline_result.json and optionally events.jsonl for audit/debug.",
    "audit_enable": true,
    "audit_topn": 50,
    "audit_snippet_chars": 240,
    "audit_in_events": true,
    "embed_batch_size": 32,
    "embed_max_retries": 3,
    "embed_sleep_sec": 0.5,
    "use_offline_index": true
  },
  "novelty": {
    "__comment__": "Local novelty check against nodes_paper.json (ICLR 2025) + pivot on high similarity. Default: do NOT auto-build index during run; build offline first.",
    "enable": true,
    "top_k": 100,
    "high_th": 0.88,
    "medium_th": 0.82,
    "auto_build_index": true,
    "index_batch_size": 32,
    "index_resume": true,
    "index_max_retries": 3,
    "index_sleep_sec": 1.0,
    "action": "pivot",
    "max_pivots": 2,
    "require_embedding": true,
    "report_in_output": false
  }
}
